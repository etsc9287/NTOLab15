ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 0.9)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.1)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15))) +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, year, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15))) +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, year, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, year, "")
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, year, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, year),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.1 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.1, -0.1, 1.15)))
summary(medal_table)
str(medal_table)
medal_table$year <- parse_character(medal_table$year)
medal_table$year <- parse_double(medal_table$year)
medal_table$year <- parse_number(medal_table$year)
medal_table$year <- parse_factor(medal_table$year)
str(medal_table)
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.75 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.75, -0.1, 1.15)))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
model1 <- lm(pop_prop ~ medal_prop, data = medal_table)
grid1 <- medal_table %>%
data_grid(medal_prop)
stats1 <- medal_table %>%
add_predictions(model1) %>%
add_residuals(model1)
View(stats1)
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
geom_line(aes(x = pop_prop, y = pred))
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
geom_line(aes(x = pop_prop, y = pred), data = stats1)
ggplot(data = medal_table) +
geom_point(aes(x = pop_prop, y = medal_prop)) +
geom_line(aes(x = pop_prop, y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot() +
geom_point(data = medal_table, aes(x = pop_prop, y = medal_prop)) +
geom_line(data = stats1, aes(x = pop_prop, y = pred)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot() +
geom_point(data = medal_table, aes(x = pop_prop, y = medal_prop)) +
geom_line(data = stats1, aes(x = pop_prop, y = pred)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(data = medal_table, mapping = aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot() +
geom_point(data = medal_table, aes(x = pop_prop, y = medal_prop)) +
geom_line(data = stats1, aes(x = pop_prop, y = pred)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(data = medal_table, aes(x = pop_prop, y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred), data = stats1, method = "lm") +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred, method = "lm"), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
model1 <- lm(medal_prop ~ pop_prop, data = medal_table)
grid1 <- medal_table %>%
data_grid(medal_prop)
stats1 <- medal_table %>%
add_predictions(model1) %>%
add_residuals(model1)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
model1 <- lm(medal_prop ~ pop_prop, data = medal_table)
ggplot(data = stats1, aes(x = pop_prop, y = resid)) +
geom_point()
cor(stats1$pop_prop, stats1$resid)
ggplot(data = stats1, aes(x = pop_prop, y = resid)) +
geom_point() +
geom_line(aes(method = "lm"))
ggplot(data = stats1, aes(x = pop_prop, y = resid)) +
geom_point()
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot(data = babies, mapping = aes(x = mpregwt)) +
geom_point(mapping = aes(y = `bwt/oz`, color = smokes)) +
geom_line(mapping = aes(y = pred), data = stats, color = "green", size = 2) +
geom_smooth(mapping = aes(y = `bwt/oz`, color = smokes), method = "lm", se = FALSE, size = 2) +
facet_wrap(~smokes)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15))) +
facet_wrap(~continent)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
geom_smmoth(aes(y = medal_prop, method = "lm")) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
facet_wrap(~continent)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
geom_smooth(aes(y = medal_prop, method = "lm")) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
facet_wrap(~continent)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
geom_smooth(aes(y = medal_prop), method = "lm") +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
facet_wrap(~continent)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
geom_smooth(aes(y = medal_prop), method = "lm", se = FALSE) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
facet_wrap(~continent)
nesting <- medal_table %>%
group_by(continents) %>%
nest()
nesting <- medal_table %>%
group_by(continent) %>%
nest()
View(nesting)
cont_model <- function(df){
lm(medal_prop ~ pop_prop, data = df)
}
nesting <- nesting %>%
mutate(model = map(data, cont_model)) %>%
mutate(pred = map(model, predict)) %>%
mutate(resid = map(model, residuals))
View(nesting)
nesting$model[[1]]
coef(model1)
nesting$model[[2]]
nesting$model[[3]]
nesting$model[[4]]
nesting$model[[3]]
nesting$model[[2]]
nesting$model[[4]]
cor(medal_table$pop_prop, medal_table$medal_prop)
medal_table <- olympics3 %>%
filter(Medal != "No Medal") %>%
inner_join(pops, by = "year") %>%
mutate(pop_prop = population / world_pop) %>%
group_by(country, continent, year, pop_prop) %>%
summarise(num_medals = n()) %>%
arrange(year) %>%
na.omit() %>%
mutate(season = if_else(year %% 4 == 0, "Summer Games", "Winter Games")) %>%
inner_join(medals, by = "year") %>%
mutate(medal_prop = num_medals / num_events) %>%
filter(continent == "Europe")
cor(medal_table$pop_prop, medal_table$medal_prop)
medal_table <- olympics3 %>%
filter(Medal != "No Medal") %>%
inner_join(pops, by = "year") %>%
mutate(pop_prop = population / world_pop) %>%
group_by(country, continent, year, pop_prop) %>%
summarise(num_medals = n()) %>%
arrange(year) %>%
na.omit() %>%
mutate(season = if_else(year %% 4 == 0, "Summer Games", "Winter Games")) %>%
inner_join(medals, by = "year") %>%
mutate(medal_prop = num_medals / num_events)
cor(medal_table$pop_prop, medal_table$medal_prop)
europe_cor <- olympics3 %>%
filter(continent == "Europe")
cor(europe_cor$pop_prop, europe_cor$medal_prop)
View(europe_cor)
europe_cor <- medal_table %>%
filter(continent == "Europe")
cor(europe_cor$pop_prop, europe_cor$medal_prop)
americas_cor <- medal_table %>%
filter(continent == "Americas")
cor(americas_cor$pop_prop, americas_cor$medal_prop)
cor(asia_cor$pop_prop, asia_cor$medal_prop)
asia_cor <- medal_table %>%
filter(continent == "Asia")
cor(asia_cor$pop_prop, asia_cor$medal_prop)
oceania_cor <- medal_table %>%
filter(continent == "Oceania")
cor(oceania_cor$pop_prop, oceania_cor$medal_prop)
nesting$model[[1]] #Oceania -
coef(model1)
nesting$model[[4]] #Asia - lower slope, stronger prediction (R = 0.44)
nesting$model[[5]] #Africa - higher slope, weaker prediction (R = 0.23)
africa_cor <- medal_table %>%
filter(continent == "Africa")
cor(africa_cor$pop_prop, africa_cor$medal_prop)
tidy_countries <- country_stats %>%
gather(seq(2,302), key = "year", value = "population")
tidy_countries$year <- parse_double(tidy_countries$year)
olympics2 <- olympics %>%
left_join(regions, by = "NOC") %>%
mutate(Medal = if_else(is.na(Medal), "No Medal", Medal)) %>%
mutate(country = region) %>%
mutate(country = if_else(country == "USA", "United States", country)) %>%
mutate(country = if_else(country == "UK", "United Kingdom", country)) %>%
mutate(country = if_else(country == "Slovakia", "Slovak Republic", country)) %>%
mutate(country = if_else(country == "Kyrgyzstan", "Kyrgyz Republic", country)) %>%
mutate(country = if_else(country == "Macedonia", "Macedonia, FYR", country)) %>%
mutate(year = Year)
olympics3 <- olympics2 %>%
inner_join(tidy_countries, by = c("country", "year")) %>%
select(-c(notes,region, Team, NOC, Games, Age, Weight, Height, Sex, Year, City)) %>%
left_join(continents, by = "country")
diagnose <- anti_join(olympics2, continents, by = "country")
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
geom_smooth(aes(y = medal_prop), method = "lm", se = FALSE) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
facet_wrap(~continent)
ggplot(data = stats1, aes(x = pop_prop, y = resid)) +
geom_point()
coef(model1)
test <- medal_table %>%
filter(medal_prop > 0.075 | pop_prop > 0.4)
View(test)
View(medal_table)
View(pops)
View(tidy_countries)
library(tidyverse)
library(stringr)
library(lubridate)
library(modelr)
library(gapminder)
olympics <- read_csv("athlete_events.csv")
regions <- read_csv("noc_regions.csv")
country_stats <- read_csv("population_total.csv")
#needs teal plot
continents <- gapminder::gapminder %>%
select(country, continent) %>%
distinct()
tidy_countries <- country_stats %>%
gather(seq(2,302), key = "year", value = "population")
tidy_countries$year <- parse_double(tidy_countries$year)
olympics2 <- olympics %>%
left_join(regions, by = "NOC") %>%
mutate(Medal = if_else(is.na(Medal), "No Medal", Medal)) %>%
mutate(country = region) %>%
mutate(country = if_else(country == "USA", "United States", country)) %>%
mutate(country = if_else(country == "UK", "United Kingdom", country)) %>%
mutate(country = if_else(country == "Slovakia", "Slovak Republic", country)) %>%
mutate(country = if_else(country == "Kyrgyzstan", "Kyrgyz Republic", country)) %>%
mutate(country = if_else(country == "Macedonia", "Macedonia, FYR", country)) %>%
mutate(year = Year)
olympics3 <- olympics2 %>%
inner_join(tidy_countries, by = c("country", "year")) %>%
select(-c(notes,region, Team, NOC, Games, Age, Weight, Height, Sex, Year, City)) %>%
left_join(continents, by = "country")
diagnose <- anti_join(olympics2, continents, by = "country")
pops <- olympics3 %>%
select(year, population) %>%
distinct() %>%
arrange(year) %>%
group_by(year) %>%
summarise(world_pop = sum(population))
medals <- olympics3 %>%
select(year, Medal) %>%
group_by(year) %>%
summarise(num_events = n())
medal_table <- olympics3 %>%
filter(Medal != "No Medal") %>%
inner_join(pops, by = "year") %>%
mutate(pop_prop = population / world_pop) %>%
group_by(country, continent, year, pop_prop) %>%
summarise(num_medals = n()) %>%
arrange(year) %>%
na.omit() %>%
mutate(season = if_else(year %% 4 == 0, "Summer Games", "Winter Games")) %>%
inner_join(medals, by = "year") %>%
mutate(medal_prop = num_medals / num_events)
model1 <- lm(medal_prop ~ pop_prop, data = medal_table)
grid1 <- medal_table %>%
data_grid(medal_prop)
stats1 <- medal_table %>%
add_predictions(model1) %>%
add_residuals(model1)
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop)) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
geom_text(aes(y = medal_prop,
label = if_else(medal_prop > 0.075 | pop_prop > 0.4, country, ""),
hjust = if_else(medal_prop > 0.075, -0.1, 1.15)))
cor(medal_table$pop_prop, medal_table$medal_prop)
coef(model1)
ggplot(data = stats1, aes(x = pop_prop, y = resid)) +
geom_point()
ggplot(data = medal_table, mapping = aes(x = pop_prop)) +
geom_point(aes(y = medal_prop, color = continent)) +
geom_smooth(aes(y = medal_prop), method = "lm", se = FALSE) +
geom_line(aes(y = pred), data = stats1) +
xlab("Country Population Proportion Out of Other Competing Countrys' Populations") +
ylab("Medal Proportion For That Year") +
ggtitle("Olympics 1896 - 2016: Country Population vs. Performance") +
facet_wrap(~continent)
nesting <- medal_table %>%
group_by(continent) %>%
nest()
cont_model <- function(df){
lm(medal_prop ~ pop_prop, data = df)
}
nesting <- nesting %>%
mutate(model = map(data, cont_model)) %>%
mutate(pred = map(model, predict)) %>%
mutate(resid = map(model, residuals))
nesting$model[[2]] #Europe - higher slope, stronger prediction (R = 0.45)
europe_cor <- medal_table %>%
filter(continent == "Europe")
cor(europe_cor$pop_prop, europe_cor$medal_prop)
nesting$model[[3]] #Americas - higher slope, stronger prediction (R = 0.64)
americas_cor <- medal_table %>%
filter(continent == "Americas")
cor(americas_cor$pop_prop, americas_cor$medal_prop)
nesting$model[[4]] #Asia - lower slope, stronger prediction (R = 0.44)
asia_cor <- medal_table %>%
filter(continent == "Asia")
cor(asia_cor$pop_prop, asia_cor$medal_prop)
nesting$model[[1]] #Oceania - higher slope, weaker prediction (R = 0.23)
oceania_cor <- medal_table %>%
filter(continent == "Oceania")
cor(oceania_cor$pop_prop, oceania_cor$medal_prop)
nesting$model[[5]] #Africa - lower slope, stronger prediction (R = 0.33)
africa_cor <- medal_table %>%
filter(continent == "Africa")
cor(africa_cor$pop_prop, africa_cor$medal_prop)
